<?xml version="1.0"?>
<robot name="robotic_arm" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <xacro:property name="mesh_package" value="package://rover_arm/meshes/" />

  <!-- Material Definitions -->
  <material name="mat_silver">
    <color rgba="0.8 0.8 0.8 1"/>
  </material>
  <link name="world" />
  <!-- Base Link -->
  <link name="base_link">
    <inertial>
      <mass value="10"/>
      <inertia ixx="0.05" ixy="0" ixz="0" iyy="0.05" iyz="0" izz="0.1"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.07" rpy="3.1415 0 0"/>
      <geometry>
        <mesh filename="${mesh_package}Joint1.stl" scale="1 1 1"/>
      </geometry>
      <material name="mat_silver"/>
    </visual>
    <visual>
      <origin xyz="0.03 0.017 0.23" rpy="-1.5707 0.16 0"/>
      <geometry>
        <mesh filename="${mesh_package}Connector1.stl" scale="1 1 1"/>
      </geometry>
      <material name="mat_silver"/>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.13 0.13 0.32"/> 
      </geometry>
    </collision>
  </link>
  <link name="link1">
    <!-- Has joint 2, link 1, and connector 2; is controlled by a revolute joint of pi freedom on y or x axis (tbd). -->
    <visual>
        <origin xyz="0 0 0" rpy="-1.568 1.22 0 " />
        <geometry>
            <mesh filename="${mesh_package}Joint2.stl" scale="1 1 1"/>
        </geometry>
        <material name="mat_silver" />
    </visual>
    <visual>
        <origin xyz="0 0.01 0.19" rpy="-1.56 0 0" />
        <geometry>
            <mesh filename="${mesh_package}Link1.stl" scale="1 1 1"/>
        </geometry>
        <material name="mat_silver" />
    </visual>
    <visual>
        <origin xyz="0 0 0.363" rpy="1.568 0 0" />
        <geometry>
            <mesh filename="${mesh_package}Connector2.stl" scale="1 1 1"/>
        </geometry>
        <material name="mat_silver" />
    </visual>
    <collision>
        <origin xyz="4 2 1" rpy="0 0 0" />
        <geometry>
            <cylinder length="0" radius="0" />
        </geometry>
    </collision>
    <inertial>
        <mass value="0.1" />
        <origin xyz="0 0 0" rpy="0 0 0" />
        <inertia ixx="0.03" iyy="0.03" izz="0.03" ixy="0.0" ixz="0.0" iyz="0.0" />
    </inertial>
</link>
<link name="link2">
        <!-- Has joint 3, link 2 and connector 3, is controlled by a revolute joint of pi freedom on y or x axis (tbd). -->
    <visual>
      <origin xyz="0.01 0.1 0" rpy="1.57 -0.22 0" />
      <geometry>
        <mesh filename="${mesh_package}Joint3.stl" scale="1 1 1"/>
      </geometry>
      <material name="mat_silver" />
  </visual>
    <visual>
       <origin xyz="0.14 0.09 0" rpy="0 0 1.56" />
      <geometry>
        <mesh filename="${mesh_package}Link2.stl" scale="1 1 1"/>
      </geometry>
       <material name="mat_silver" />
   </visual>
    <visual>
      <origin xyz="0.26 0.07 0" rpy="1.55 -1.38 0" />
      <geometry>
         <mesh filename="${mesh_package}Connector3.stl" scale="1 1 1"/>
      </geometry>
       <material name="mat_silver" />
   </visual>
  <collision>
      <origin xyz="1.45 0 0" rpy="0 1.5707 0" />
       <geometry>
           <cylinder length="0" radius="0" />
      </geometry>
   </collision>
  <inertial>
      <mass value="0.1" />
      <origin xyz="0 0 0" rpy="0 0 0" />
      <inertia ixx="0.03" iyy="0.03" izz="0.03" ixy="0.0" ixz="0.0" iyz="0.0" />
  </inertial>
</link>
<link name="link3">
        <!-- Has joint 4 and a possible end effector, is controlled by a revolute joint of pi freedom on x or y axis (tbd).-->
       
    <visual>
       <origin xyz="-0.39 0 0.194" rpy="1.557 2 0" />
       <geometry>
        <mesh filename="${mesh_package}Joint4.stl" scale="1 1 1"/>
      </geometry>
       <material name="mat_silver" />
  </visual>
  <collision>
       <origin xyz="0 0 0" rpy="0 1.5707 0" />
       <geometry>
          <cylinder length="0" radius="0" />
      </geometry>
  </collision>
  <inertial>
      <mass value="0.1" />
      <origin xyz="0 0 0" rpy="0 0 0" />
      <inertia ixx="0.03" iyy="0.03" izz="0.03" ixy="0.0" ixz="0.0" iyz="0.0" />
  </inertial>
</link>

<joint name="joint1" type="continuous">
        <parent link="world" />
        <child link="base_link" />
        <origin xyz="0 0 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit velocity="100" effort="100" />
</joint>
<joint name="joint2" type="revolute">
        <parent link="base_link" />
        <child link="link1" />
        <origin xyz="0.03 0.18 0.24" rpy="0 0 0" />
        <axis xyz="0 -1 0" />
        <limit lower="-1.5707" upper="0" velocity="100" effort="100" />
</joint>
<joint name="joint3" type="revolute">
        <parent link="link1" />
        <child link="link2" />
        <origin xyz="0 -0.24 0.37" rpy="0 0 0" />
        <axis xyz="0 1 0" />
        <limit lower="0" upper="1.5707" velocity="100" effort="100" />
    </joint>
 <joint name="joint4" type="revolute">
        <parent link="link2" />
        <child link="link3" />
        <origin xyz="0.25 0.2 0" rpy="0 0 0" />
        <axis xyz="0 1 0" />
        <limit lower="-1.5707" upper="0" velocity="100" effort="100" />
    </joint>
   <plugin name="gazebo_ros_control">
            <robotNamespace>/</robotNamespace>
        </plugin>
    <gazebo reference="base_link">
        <material>Gazebo/Green</material>
        
    </gazebo>
    <gazebo reference="link1">
        <material>Gazebo/Blue</material>
    </gazebo>
    <gazebo reference="link2">
        <material>Gazebo/Orange</material>
    </gazebo>
    <gazebo reference="link3">
        <material>Gazebo/Red</material>
    </gazebo>
   <gazebo>
    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
      <robotNamespace>/robotic_arm</robotNamespace>
    </plugin>
  </gazebo>
    <gazebo>
        <plugin name="gazebo_ros_joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
            <update_rate>20</update_rate>
            <joint_name>joint1</joint_name>
            <joint_name>joint2</joint_name>
            <joint_name>joint3</joint_name>
            <joint_name>joint4</joint_name>
        </plugin>
    </gazebo>
   <gazebo>
        <plugin name="gazebo_ros_joint_pose_trajectory" filename="libgazebo_ros_joint_pose_trajectory.so">
            <update_rate>2</update_rate>
        </plugin>
    </gazebo>
    <transmission name="trans_joint1">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="joint1">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
        </joint>
        <actuator name="joint1_motor">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>
    <transmission name="trans_joint2">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="joint2">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
        </joint>
        <actuator name="joint2_motor">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>
    <transmission name="trans_joint3">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="joint3">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
        </joint>
        <actuator name="joint3_motor">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>
    <transmission name="trans_joint4">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="joint4">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="joint4_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

  </robot>